var AppCore=function(){function t(){}var e=__define,i=t,r=i.prototype;return e(t,"$i",function(){return this._$i||(this._$i=new t),this._$i}),r.onResourceLoadComplete=function(t){switch(t.groupName){case"loading":city.Util.trace(this,"loading","-]:",egret.getTimer()),LoadingUI.$i.displayLoadingIcon(),city.Util.trace(this,"[-","game:",egret.getTimer()),RES.loadGroup("game-assets");break;case"game-assets":city.Util.trace(this,"game-assets","-]:",egret.getTimer()),Global.assetsDepot=StrongAssets.extract("egret-group"),Global.dictDynCfg=StrongAssets.extract("dynamic-config"),this.launch()}},r.launch=function(){LoadingUI.$i&&LoadingUI.$i.parent&&LoadingUI.$i.parent.removeChild(LoadingUI.$i),this._view.launch()},r.init=function(t){city.Util.trace(this,"init"),this._view=new AppView,this._view.addEventListener(AppView.EVT_BUTTON,this.viewButtonHandler,this),t.addChild(this._view),this._iStepCount=-1,this._dictTopicLoaded={},t.stage.addChild(LoadingUI.$i),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.itemLoadErrHandler,this),RES.loadConfig("resource/resource.json","resource/")},r.itemLoadErrHandler=function(t){throw new Error(this+" err:"+t.resItem.toString())},r.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),city.Util.trace(this,"[-","load loading:",egret.getTimer()),RES.loadGroup("loading")},r.viewButtonHandler=function(t){var e=Number(t.data);city.Util.trace(this,"viewButtonHandler idBtn:",e)},r.loadTopicContent=function(t){this._idTopicCurr=t;var e="quiz-"+this._idTopicCurr;this._dictTopicLoaded[e]?(city.Util.trace(this,"loadTopicContent topic already:",e),this.launchTopicCurr(e)):(RES.createGroup(e,[e]),city.Util.trace(this,"loadTopicContent  [-topic curr:",e,egret.getTimer()),RES.loadGroup(e))},r.launchTopicCurr=function(t){this._iStepCount+=1},r.onResourceProgress=function(t){LoadingUI.$i.setProgress(t.itemsLoaded,t.itemsTotal)},r.toString=function(){return"[AppCore]"},t.toString=function(){return"[$AppCore$]"},t}();egret.registerClass(AppCore,"AppCore");var AssetsInfo=function(){function t(){}var e=(__define,t);e.prototype;return t.getRdmId=function(){return this.$vcAssetsId[Math.floor(this.$vcAssetsId.length*Math.random())]},t.$vcAssetsId=new Array("EgretAndroid","EgretDragonBones","EgretEngine","EgretFeather","EgretInspector","EgretiOSsupport","EgretLark","EgretRuntime","EgretVS","EgretWing","TextureMerger","TSConversion"),t}();egret.registerClass(AssetsInfo,"AssetsInfo");var Bootstrap=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.onAddToStage=function(t){Layout.wNorm=this.stage.stageWidth,Layout.hNorm=this.stage.stageHeight,city.Util.trace(this,"stage:",this.stage),AppCore.$i.init(this)},r.toString=function(){return"[Bootstrap]"},e}(egret.DisplayObjectContainer);egret.registerClass(Bootstrap,"Bootstrap");var ButtonId=function(){function t(){}var e=(__define,t);e.prototype;return t.ADD=1,t.RM=2,t.CLEAR=3,t.SWROTATION=5,t.SWMOVE=6,t.SWRUN=7,t.SW_RENDER_TYPE=8,t.SW_AUTO_DIRTY=9,t}();egret.registerClass(ButtonId,"ButtonId");var Global=function(){function t(){}var e=(__define,t);e.prototype;return t.bDebug=!0,t.vRegionRange=6.7,t.vRegionBase=2.1,t.vMinRange=.5,t.vMinBase=.1,t.rRange=2.1,t.rBase=.8,t}();egret.registerClass(Global,"Global");var Layout=function(){function t(){}var e=(__define,t);e.prototype;return t.wNorm=640,t.hNorm=1008,t}();egret.registerClass(Layout,"Layout");var Links=function(){function t(){}var e=(__define,t);e.prototype;return t.uVideo="launcher/video.html",t}();egret.registerClass(Links,"Links");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},r.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},r.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},r.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},r.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},r.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},r.createGameScene=function(){var t=this.createBitmapByName("bgImage");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i;var r=new egret.Shape;r.graphics.beginFill(0,.5),r.graphics.drawRect(0,0,e,i),r.graphics.endFill(),r.width=e,r.height=i,this.addChild(r);var n=this.createBitmapByName("egretIcon");this.addChild(n),n.scaleX=.55,n.scaleY=.55,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=e/2,n.y=i/2-60;var o=new egret.TextField;o.textColor=16777215,o.textAlign="center",o.text="Hello Egret",o.size=20,o.x=e-o.width>>1,o.y=(i-o.height>>1)+50,this.addChild(o);var a=new egret.TextField;this.addChild(a),a.alpha=0,a.width=e,a.textAlign=egret.HorizontalAlign.CENTER,a.x=0,a.y=i/2+100,this.textfield=a,RES.getResAsync("description",this.startAnimation,this)},r.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},r.startAnimation=function(t){for(var e=this,i=new egret.HtmlTextParser,r=[],n=0;n<t.length;n++)r.push(i.parser(t[n]));var o=e.textfield,a=-1,s=function(){a++,a>=r.length&&(a=0);var t=r[a];e.changeDescription(o,t);var i=egret.Tween.get(o);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(s,e)};s()},r.changeDescription=function(t,e){t.textFlow=e},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var ArrayUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.removeElem=function(t,e){var i=e.indexOf(t);return-1!=i?(e.splice(i,1),!0):!1},t.shuffle=function(t){for(var e=t.length-1;e>-1;--e){var i=Math.floor(t.length*Math.random()),r=t[e];t[e]=t[i],t[i]=r}},t.getRdmElem=function(t,e,i,r){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===r&&(r=-1),-1==r&&(r=t.length);var n=r-i,o=this.getRdmIdx(n,i);return e?t.splice(o,1)[0]:t[o]},t.getRdmIdx=function(t,e){return void 0===e&&(e=0),e+Math.floor(Math.random()*t)},t.getSeriesNumArr=function(t,e){if(void 0===e&&(e=0),0>=t)return[];for(var i=new Array,r=e+t-1;r>=e;--r)i.unshift(r);return i},t}();egret.registerClass(ArrayUtil,"ArrayUtil");var BrowserUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.updateURL=function(t){window.open(t,"_self")},t.refreshSelf=function(){location.reload()},t}();egret.registerClass(BrowserUtil,"BrowserUtil");var ButtonHasId=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.toString=function(){return"[btn"+this.id.toString()+"]"},e}(egret.Bitmap);egret.registerClass(ButtonHasId,"ButtonHasId");var ComplexTextLine=function(t){function e(e){t.call(this);for(var i,r=0,n=0;n<e.length;++n)i=e[n],i.x=r,r+=i.width,t.prototype.addChild.call(this,i)}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Sprite);egret.registerClass(ComplexTextLine,"ComplexTextLine");var ComplexTextPara=function(t){function e(e){t.call(this);for(var i=0,r=0;r<e.length;++r)e[r].width>i&&(i=e[r].width);for(var n=0,r=0;r<e.length;++r)e[r].x=(i-e[r].width)/2,e[r].y=n,n+=e[r].height,this.addChild(e[r])}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Sprite);egret.registerClass(ComplexTextPara,"ComplexTextPara");var ComplexTextUnit=function(t){function e(e,i){t.call(this),this.fontFamily="微软雅黑",this.textColor=i,this.size=40,this.text=e}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.TextField);egret.registerClass(ComplexTextUnit,"ComplexTextUnit");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=__define,r=e,n=r.prototype;return i(e,"$i",function(){return null==this._$i&&(this._$i=new e),this._$i}),n.createView=function(){this._icon=new egret.Bitmap,this.addChild(this._icon),this._tx=new egret.TextField,this.addChild(this._tx)},n.displayLoadingIcon=function(){var t=StrongAssets.extract("loading",!0);t&&(this._icon.texture=t,this._icon.x=(Layout.wNorm-this._icon.width)/2,this._icon.y=(Layout.hNorm-this._icon.height)/2,this._tx.x=(Layout.wNorm-this._tx.width)/2,this._tx.y=(Layout.hNorm-this._tx.height)/2+this._icon.height+10)},n.setProgress=function(t,e){this._tx.text="努力加载中... "+Math.round(t/e*100)+"%",this._tx.x=(Layout.wNorm-this._tx.width)/2,this._tx.y=(Layout.hNorm-this._tx.height)/2+this._icon.height+10},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Mark=function(t){function e(e,i){t.call(this),this.graphics.lineStyle(1,e),this.graphics.beginFill(i),this.graphics.drawRect(0,0,10,10),this.graphics.endFill()}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Shape);egret.registerClass(Mark,"Mark");var Namer=function(){function t(){}var e=__define,i=t;i.prototype;return e(t,"getOne",function(){return++this.count,"obj_"+this.count}),t.count=0,t}();egret.registerClass(Namer,"Namer");var city;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.getRepeatString=function(t,e){if(0>=e)throw new Error("哥们，你逗我玩呢吧!");for(var i=t,r=e;r>1;--r)i=t+i;return i},t}();t.StringUtil=e,egret.registerClass(e,"city.StringUtil")}(city||(city={}));var StrongAssets=function(){function t(){}var e=(__define,t);e.prototype;return t.extract=function(t,e){void 0===e&&(e=!1);var i=RES.getRes(t);if(void 0!=i)return i;if(!e)throw new Error("这资源("+t+")特么的不存在！");city.Util.trace(this,"extract failed!"+t)},t.extractTxtrFromSheet=function(t,e,i){void 0===i&&(i=!1);var r=e.getTexture(t);if(void 0!=r)return r;if(!i)throw new Error("这sheet纹理("+t+")特么的不存在！");city.Util.trace(this,"extract failed!"+t)},t.toString=function(){return"[-StrongAssets-]"},t}();egret.registerClass(StrongAssets,"StrongAssets");var TxButtonHasId=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.toString=function(){return"[txbtn"+this.id.toString()+"]"},e}(egret.TextField);egret.registerClass(TxButtonHasId,"TxButtonHasId");var city;!function(t){var e=function(){function e(){}var i=__define,r=e;r.prototype;return e.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];Global.bDebug&&console.log(t.join(" "))},e.traceInHtml=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];Global.bDebug&&document.getElementById("info")&&(this.htmlDebug+=t.join(" ")+"<br>",document.getElementById("info").innerHTML=this.htmlDebug)},e.parseUpMysticalVisual=function(e){for(var i=new Array;e;)i.push(e+(e.name?" n:"+e.name:"")+" a:"+e.alpha+" v:"+e.visible+" x:"+e.x+" y:"+e.y+" w:"+e.width+" h:"+e.height),e=e.parent;for(var r="--- --- --- parseMysticalVisual:",n=i.length-1;n>-1;--n)r+="\n"+t.StringUtil.getRepeatString("	",i.length-n)+i[n];return r=r},e.charIsNum=function(t){return t>="0"&&"9">=t},e.charIsLower=function(t){return t>="a"&&"z">=t},e.charIsUpper=function(t){return t>="A"&&"Z">=t},e.viewThru=function(t,e,i,r,n){if(void 0===e&&(e=!1),void 0===i&&(i=1),void 0===r&&(r=3),void 0===n&&(n=""),!t)return"";var o=!1,a="";1==i&&(a+="\n┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯\n");var s=0;for(var h in t)if(o=!0,0!=h.indexOf("_")){var c=t[h],g=typeof c;if("function"!=g){var u=null!=c?c+" ("+g+")":"<未定义>",d=e?this.getBrief(u.toString(),24,20,10,!1):u,l=" "+h+" :"+d;if(a+=this.getIndent(i)+l+"\n",null!=c&&r>i&&(a+=this.viewThru(c,e,i+1,r)),++s>9){a+=this.getIndent(i)+"......\n";break}}}return 1==i&&(a+="┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷"),o?a:""},e.getIndent=function(t){for(var e="",i=t;i>1;--i)e+=" │";return e+" ├"},e.getBrief=function(t,e,i,r,n){return void 0===e&&(e=600),void 0===i&&(i=600),void 0===r&&(r=20),void 0===n&&(n=!0),t.length<=e+i+r?t:n?t.slice(0,t.slice(0,e).lastIndexOf("\n"))+"\n\n	... ... ...\n\n"+t.slice(-i+t.slice(-i).indexOf("\n")+1):t.slice(0,e)+"... ..."+t.slice(-i)},e.race=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},i(e,"urlRandomPostfix",function(){return"?pfr="+egret.getTimer().toString()+Math.ceil(1e5*Math.random())}),e.resetDebugMark=function(){Global.bDebug&&(this.clearDebugMark(),null==this._aDebugPoint&&(this._aDebugPoint=new Array))},e.clearDebugMark=function(){if(Global.bDebug&&this._aDebugPoint&&this._aDebugPoint.length)for(var t;this._aDebugPoint.length;)t=this._aDebugPoint.pop(),t&&t.parent&&t.parent.removeChild(t)},e.layoutTxButtonHasId=function(t,e,i,r,n,o,a,s,h,c){void 0===h&&(h=20),void 0===c&&(c=.5),e.id=t,e.fontFamily="Verdana",e.textColor=0,e.size=h,e.stroke=1.2,e.x=r,e.y=n,e.textAlign=egret.HorizontalAlign.LEFT,e.text=i,e.cacheAsBitmap=!0,a?(e.strokeColor=0,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,a,s),e.textColor=16777215):(e.strokeColor=6710886,e.touchEnabled=!1,e.textColor=16777215),o.addChild(e)},e.createBitmapByName=function(t){var e=new egret.Bitmap,i=StrongAssets.extract(t);return e.texture=i,e},e.bezier=function(t,e,i,r,n,o,a,s){var h=1-t,c=t*t,g=2*t*h,u=h*h;s.x=c*e+g*r+u*o,s.y=c*i+g*n+u*a},e.htmlDebug="",e}();t.Util=e,egret.registerClass(e,"city.Util")}(city||(city={}));var city;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.compileProgram=function(e,i,r){var n=t.compileFragmentShader(e,r),o=t.compileVertexShader(e,i),a=e.createProgram();return e.attachShader(a,o),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS),a},t.compileFragmentShader=function(e,i){return t._compileShader(e,i,e.FRAGMENT_SHADER)},t.compileVertexShader=function(e,i){return t._compileShader(e,i,e.VERTEX_SHADER)},t._compileShader=function(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:null},t.checkCanUseWebGL=function(){if(void 0==t.canUseWebGL)try{var e=document.createElement("canvas");t.canUseWebGL=!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(i){t.canUseWebGL=!1}return t.canUseWebGL},t}();t.WebGLUtils=e,egret.registerClass(e,"city.WebGLUtils")}(city||(city={}));var city;!function(t){var e;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.addTarget=function(e,i,r,n){null==this._dictName2TriggerUnit&&(this._dictName2TriggerUnit=new Object,egret.Ticker.getInstance().register(this.advance,this)),null==this._vcActiveName&&(this._vcActiveName=new Array),this.register(r,n),e.name=Namer.getOne,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),e.addEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this),this._dictName2TriggerUnit[e.name]=new t.TouchTriggerUnit(i),console.log("addTarget:",this._dictName2TriggerUnit[e.name])},e.touchHandler=function(t){var e=t.currentTarget.name,i=this._dictName2TriggerUnit[e];switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:i.startTime(egret.getTimer()),this._vcActiveName.push(e);break;case egret.TouchEvent.TOUCH_END:this._vcActiveName.splice(this._vcActiveName.indexOf(e))}},e.advance=function(t){if(this._vcActiveName.length){var e=egret.getTimer();for(var i in this._vcActiveName){var r=this._dictName2TriggerUnit[this._vcActiveName[i]];if(r.checkAndUpdateTrigger(e))for(var n=this._vcHandler.length-1;n>-1;--n)this._vcHandler[n].apply(this._vcHostHandler[n],[r.id])}}},e.register=function(t,e){null==this._vcHandler&&(this._vcHandler=new Array,this._vcHostHandler=new Array),(-1==this._vcHandler.indexOf(t)||this._vcHandler.indexOf(t)!=this._vcHostHandler.indexOf(e))&&(this._vcHandler.push(t),this._vcHostHandler.push(e))},e}();t.TouchTriggerCenter=e,egret.registerClass(e,"city.touch.TouchTriggerCenter")}(e=t.touch||(t.touch={}))}(city||(city={}));var city;!function(t){var e;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.DELAY=0,t.INTERVEL=1,t}();egret.registerClass(e,"TouchTriggerPhase")}(e=t.touch||(t.touch={}))}(city||(city={}));var city;!function(t){var e;!function(t){var e=function(){function t(t){this.id=t}var e=(__define,t),i=e.prototype;return i.startTime=function(e){this.tmNextTrigger=e+t.tmDelayFirstTrigger},i.checkAndUpdateTrigger=function(e){return console.log("checkAndUpdateTrigger:",e,this.tmNextTrigger),e>this.tmNextTrigger?(this.tmNextTrigger=this.tmNextTrigger+t.tmIntervalTrigger,!0):!1},t.tmDelayFirstTrigger=400,t.tmIntervalTrigger=80,t}();t.TouchTriggerUnit=e,egret.registerClass(e,"city.touch.TouchTriggerUnit")}(e=t.touch||(t.touch={}))}(city||(city={}));var AppView=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),r=i.prototype;return r.launch=function(){this._bWebGLSupport=!1,city.Util.trace(this,"launch w h:",this.stage.stageWidth,this.stage.stageHeight),this.layBg();var e=64;this._regionActive=new RectPlus(e,e,this.stage.stageWidth-2*e,this.stage.stageHeight-2*e),this._vcImage=new Array,this._vcImgStatus=new Array,this._countAdvance=0,this._vUIControl=new egret.Sprite,this._vUIControl.touchEnabled=!0,this._vUIControl.touchChildren=!0,this._vUIControl.cacheAsBitmap=!0,t.prototype.addChild.call(this,this._vUIControl);var i=new egret.Bitmap(RES.getRes("egretIcon"));i.scaleX=.5,i.scaleY=.5,i.alpha=.5,i.x=this.stage.stageWidth-.5*i.width-10,i.y=10,this._vUIControl.addChild(i);var r,n=40,o=8;this._txInfo2=new TxButtonHasId,this._txInfo2.width=270,city.Util.layoutTxButtonHasId(-1,this._txInfo2,"browser: "+navigator.platform+"-"+navigator.appName+"\nvendor:"+navigator.vendor+"\ncode:"+navigator.appCodeName+"\nversion:"+navigator.appVersion,5,100,this._vUIControl,null,null,16,0),this._txInfo2.y=this.stage.stageHeight-this._txInfo2.height-10,this._txSwitchRenderType=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.SW_RENDER_TYPE,this._txSwitchRenderType,"now:"+sessionStorage.getItem("rendererType")+" "+(this._bWebGLSupport?"h5"==sessionStorage.getItem("rendererType")?"-->webgl":"-->h5":",NO webgl!"),150,r=10,this._vUIControl,this.txButtonHandler,this,28,0),this._txSwitchRenderType.parent.removeChild(this._txSwitchRenderType),this._txCount=new TxButtonHasId,city.Util.layoutTxButtonHasId(-1,this._txCount,"count:",280,r=this.stage.stageHeight-o*n,this._vUIControl,null,null,28,0),this._txbtnAdd=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.ADD,this._txbtnAdd,"add 10",280,r+=n,this._vUIControl,this.txButtonHandler,this,28,0),city.touch.TouchTriggerCenter.addTarget(this._txbtnAdd,ButtonId.ADD,this.touchTriggerHandler,this),this._txbtnRemove=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.RM,this._txbtnRemove,"remove 10",280,r+=n,this._vUIControl,this.txButtonHandler,this,28,0),city.touch.TouchTriggerCenter.addTarget(this._txbtnRemove,ButtonId.RM,this.touchTriggerHandler,this),this._txbtnClear=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.CLEAR,this._txbtnClear,"clear",280,r+=n,this._vUIControl,this.txButtonHandler,this,28,0),city.touch.TouchTriggerCenter.addTarget(this._txbtnClear,ButtonId.CLEAR,this.touchTriggerHandler,this),this._bRotation=!0,this._txSwitchRotation=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.SWROTATION,this._txSwitchRotation,"rotation:true",280,r+=n,this._vUIControl,this.txButtonHandler,this,28,0),this._bMove=!0,this._txSwitchMove=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.SWMOVE,this._txSwitchMove,"move:true",280,r+=n,this._vUIControl,this.txButtonHandler,this,28,0),this._bRun=!0,this._txSwitchRun=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.SWRUN,this._txSwitchRun,"run:true",280,r+=n,this._vUIControl,this.txButtonHandler,this,28,0),this._bAutoDirty=!0,this._txSwitchAutoDirty=new TxButtonHasId,city.Util.layoutTxButtonHasId(ButtonId.SW_AUTO_DIRTY,this._txSwitchAutoDirty,"a dirty:true",280,r+=n,this._vUIControl,this.txButtonHandler,this,28,0),egret.Ticker.getInstance().register(this.advance,this),this.initCountFromStorage()},r.initCountFromStorage=function(){var t=this;if(window.onbeforeunload=function(){sessionStorage.setItem("count",t._vcImage.length.toString())},sessionStorage.getItem("count")){var e=sessionStorage.getItem("count");isNaN(e)||this.addItem(e)}},r.addItem=function(e){for(var i=0;e>i;++i)this.addRdmImage();t.prototype.addChild.call(this,this._vUIControl),this._txCount.text="count:"+this._vcImage.length},r.removeItem=function(t){for(var e=0;t>e;++e)this.removeImage();this._txCount.text="count:"+this._vcImage.length},r.touchTriggerHandler=function(t){switch(t){case ButtonId.ADD:this.addItem(10);break;case ButtonId.RM:this.removeItem(10)}},r.txButtonHandler=function(t){var e=t.currentTarget.id;switch(e){case ButtonId.ADD:case ButtonId.RM:this.touchTriggerHandler(e);break;case ButtonId.CLEAR:this.removeItem(this._vcImage.length);break;case ButtonId.SWROTATION:this._txSwitchRotation.text="rotation:"+(this._bRotation=!this._bRotation);break;case ButtonId.SWMOVE:this._txSwitchMove.text="move:"+(this._bMove=!this._bMove);break;case ButtonId.SWRUN:this._txSwitchRun.text="run:"+(this._bRun=!this._bRun),this._bRun?egret.Ticker.getInstance().register(this.advance,this):egret.Ticker.getInstance().unregister(this.advance,this);break;case ButtonId.SW_AUTO_DIRTY:this._txSwitchAutoDirty.text="a dirty:"+(this._bAutoDirty=!this._bAutoDirty),this._bAutoDirty?this.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.ON:this.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.OFF;break;case ButtonId.SW_RENDER_TYPE:this._txSwitchRenderType.touchEnabled=!1,sessionStorage.setItem("count",this._vcImage.length.toString()),this._bWebGLSupport&&("h5"==sessionStorage.getItem("rendererType")?sessionStorage.setItem("rendererType","webgl"):sessionStorage.setItem("rendererType","h5")),location.reload()}},r.addRdmImage=function(){var e=new egret.Bitmap(StrongAssets.extract(AssetsInfo.getRdmId()));this._vcImage.push(e),this._vcImgStatus.push(new ImgStatus),e.anchorOffsetX=.5*e.texture.textureWidth,e.anchorOffsetY=.5*e.texture.textureHeight,e.x=this._regionActive.x+this._regionActive.width*Math.random(),e.y=this._regionActive.y+this._regionActive.height*Math.random(),e.rotation=360*Math.random(),t.prototype.addChild.call(this,e)},r.removeImage=function(){if(this._vcImage.length){var t=this._vcImage.pop();t.parent&&t.parent.removeChild(t)}this._vcImgStatus.length&&this._vcImgStatus.pop()},r.advance=function(t){if(++this._countAdvance,this._countAdvance%1==0)for(var e,i,r,n,o,a,s=this._vcImage.length-1;s>-1;--s)e=this._vcImage[s],i=this._vcImgStatus[s],this._bRotation&&(e.rotation+=i.rDelta),this._bMove&&(o=i.dx*(i.vMin+i.vRegion*(1-Math.abs(e.x-this._regionActive.xCen)/this._regionActive.wHalf)),r=e.x+o,r>this._regionActive.x&&r<this._regionActive.right?e.x=r:(i.dx*=-1,i.updateVelocity()),a=i.dy*(i.vMin+i.vRegion*(1-Math.abs(e.y-this._regionActive.yCen)/this._regionActive.hHalf)),n=e.y+a,n>this._regionActive.y&&n<this._regionActive.bottom?e.y=n:(i.dy*=-1,i.updateVelocity()))},r.logStageInfo=function(){var e=new egret.TextField;e.x=20,e.y=80,e.fontFamily="微软雅黑",e.textColor=0,e.size=12,e.text="舞台宽高："+this.stage.stageWidth+","+this.stage.stageHeight+"\n缩放模型："+this.stage.scaleMode,t.prototype.addChild.call(this,e)},r.layBg=function(){var t=new egret.Shape;t.graphics.lineStyle(0,65535),t.graphics.beginFill(3368601),t.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),t.graphics.endFill(),t.cacheAsBitmap=!0,this.addChild(t)},r.toString=function(){return"[AppView]"},e.EVT_BUTTON="EVT_BUTTON",e}(egret.Sprite);egret.registerClass(AppView,"AppView");var ImgStatus=function(){function t(){this.dx=Math.random()>.5?-1:1,this.dy=Math.random()>.5?1:-1,this.updateVelocity()}var e=(__define,t),i=e.prototype;return i.updateVelocity=function(){this.vMin=Global.vMinBase+Global.vMinRange*Math.random(),this.vRegion=Global.vRegionBase+Global.vRegionRange*Math.random(),this.rDelta=(Global.rBase+Global.rRange*Math.random())*(Math.random()>.5?1:-1)},t}();egret.registerClass(ImgStatus,"ImgStatus");var RectPlus=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=__define,r=e,n=r.prototype;return i(n,"xCen",function(){return this.x+this.width/2}),i(n,"yCen",function(){return this.y+this.height/2}),i(n,"wHalf",function(){return this.width/2}),i(n,"hHalf",function(){return this.height/2}),e}(egret.Rectangle);egret.registerClass(RectPlus,"RectPlus");